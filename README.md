# 金融交易数据处理程序

这是一个C++程序，用于处理金融交易数据并计算各种统计指标。

## 功能特性

- 读取CSV格式的交易数据
- 计算每个交易品种的统计信息：
  - 最大时间间隔
  - 总交易量
  - 加权平均价格
  - 最高价格
- 使用现代C++17特性
- 模板化设计，支持扩展
- 完整的单元测试

## 设计特点

### 1. 模板设计
- `TradeProcessor<StatsCalculator>` 模板类
- 支持不同的统计计算器
- 易于扩展新的统计指标

### 2. 面向对象设计
- 接口抽象 (`ITradeDataReader`, `ITradeDataWriter`)
- 策略模式 (`BaseStatsCalculator`)
- 单一职责原则

### 3. 内存效率
- 流式处理，支持大数据集
- 避免将整个数据集加载到内存

## 构建和运行

### 构建项目
```bash
mkdir build
cd build
cmake ..
make
```

### 运行程序

```bash
./financial_calc
```
在运行程序之前，确保输入文件位于build路径下。输入文件的名称应该命名为input.csv。   
程序运行结束后，会在build路径下生成output.csv输出文件

### 运行测试
```bash
./trade_processor_test
```

### 随机测试集
笔者提供了一个建议的python脚本用于自动生成一个测试集。目前，默认生成测试集的大小为0.1GB,生成测试集中symbol类型为17575种( $ 26 \times26\times26 - 1 $),默认存放的位置在build路径下，需要先创建build路径才可运行。命令如下所示：

```bash
python generateTests.py 0.1 //生成大小为0.1GB的测试集
```

## 扩展性

程序设计支持轻松添加新的统计指标：

1. 继承 `BaseStatsCalculator` 类
2. 实现 `updateStats` 和 `finalizeStats` 方法
3. 使用新的计算器类型实例化 `TradeProcessor`

## 测试

### 单元测试

程序包含完整的单元测试，覆盖：
- 基本功能测试
- 单笔交易处理
- 加权平均价格计算
- 时间间隔计算
- 扩展计算器功能

### 大数据集测试

截止目前，受限于时间原因，笔者最大仅测试了1GB的测试集，测试集的symbol类型数为17575，程序顺利运行并且输出一个完全正常的output.csv。  
这个程序所需的内存随交易品种数量的增长而增长，读取的数据读后即清理，只要计算机内存大小为数量级为GB，即可轻松处理TB级别的数据。

## 时间投入

开发与测试时间：约1.5小时